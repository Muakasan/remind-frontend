<!DOCTYPE HTML>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Create Module</title>
        <link rel="stylesheet" href="../css/foundation.css"/>
        <link rel="stylesheet" href="../css/remind-style.css">
        <link rel="stylesheet" href="../css/remind-style.css" />
        <script src="../js/vendor/modernizr.js"></script>
        <script src="../js/vendor/jquery.js"></script>
        <script src="../js/foundation.min.js"></script>
        <script src="../jquery-ui-1.11.4.custom/jquery-ui.min.js"></script>
        <script src="../tag-it-master/js/tag-it.js"></script>
        <link rel="stylesheet" href="../jquery-ui-1.11.4.custom/jquery-ui.css" />
        <link rel="stylesheet" href="../tag-it-master/css/jquery.tagit.css"/>
    </head>
    <body>
        <nav class="top-bar" data-topbar role="navigation">
            <ul class="title-area">
                <li class="name">
                    <h1><a href="#">Remind</a></h1>
                </li>
            </ul>
            <section class="top-bar-section">
                <ul class="right">
                    <li><a href="#">Manage Courses</a></li>
                    <li><a href="#">My Courses</a></li>
                    <li><a href="#">Manage Instructors</a></li>
                    <li><a href="#">Manage Students</a></li>
                    <li><a href="#">Me</a></li>
                </ul>
            </section>
        </nav>
        <div class="row">
            <div class="large-12 medium-12 small-12">
                <h1>Create Mathematics 101</h1>
            </div>
        </div>
        <div class="row">
            <a id="add_question_btn" class="button semiround" href="#">Add a Question</a>
        </div>
        <div class="row">
            <ul id="accordion" class="accordion" data-accordion>
                <li class="accordion-navigation">
                    <a href="#panel">Which Class has the Highest Wavelength?<label>Multiple Choice</label></a>        
                    <div id="panel" class="content">
                        <button href="#" data-dropdown="question_type_drop" class="button dropdown semiround">Question Type</button>
                        <ul id="question_type_drop" data-dropdown-content class="f-dropdown semiround" aria-hidden="true">
                            <li><a href="#">Multiple Choice</a></li>
                            <li><a href="#">Free Response</a></li>
                            <li><a href="#">Fill in The Blank</a></li>
                            <li><a href="#">Matching</a></li>
                        </ul>
                    </div>
                </li>
            </ul>
        </div>
        <br><br>
        <script>
            $(document).foundation();
            
            var getQuestionNumber = function(panel){
                panel_id = panel.attr("id");
                return String(panel_id.substring(panel_id.indexOf('-')+1));
            }
            
            var getPanel = function(element){
                return element.closest("[id^='panel']");
            }

            var count = 0; //count which is used to mark question number

            // code to create a new question by adding to the accordion
            $("#add_question_btn").click(function(){ 
                count++;

                //add id to prompt textarea?
                //attach a question to the accordion
                $("#accordion").append(
                    $("<li>", {"class":"accordion-navigation"}).append(
                        $("<a>", {
                            "href": "#panel-" + count,
                            "text": "New Question"
                            }),
                        $("<div>", {
                            "id": "panel-" + count,
                            "class": "content"
                            }).append(
                            $("<h4>",{"text":"Prompt:"}),
                            $("<textarea>"),
                            //this handles the question type dropdown menu
                            $("<button>",{
                                "data-dropdown": "question-type-drop-" + count,
                                "class": "button dropdown semiround",
                                "text": "Question Type"
                                }),
                            $("<ul>", {
                                "data-dropdown-content": true,
                                "id": "question-type-drop-" + count,
                                "class": "f-dropdown semiround",
                                "aria-hidden": true,
                                }).append(
                                $("<li>").append(
                                    $("<a>", {
                                        "href": "#",
                                        "text": "Multiple Choice"
                                        })),
                                $("<li>").append(
                                    $("<a>", {
                                        "href": "#",
                                        "text": "Free Response"
                                        })),
                                $("<li>").append(
                                    $("<a>", {
                                        "href": "#",
                                        "text": "Fill in the Blank"
                                        })),
                                $("<li>").append(
                                    $("<a>", {
                                        "href": "#",
                                        "text": "Matching"
                                        }
                                    )
                                )                                
                            ),
                            $("<div>", {
                                "id": "question-div-" + count
                            }),
                            $("<ul>", {
                                "id": "myTags-" + count
                            })
                        )
                    )
                );
                //tags are created by putting a ul in the html code with an id and then calling the following tagit code with a corresponding id 
                $("#myTags-" + count).tagit({
                    placeholderText: "Search...",
                    caseSensitive: false
                });
            });

            //checks when the dropdown is clicked by looking for li elements which are descendents of the content class
            $("#accordion").on("click", ".content li", function(){
                var questionType = $(this).children().text(); //gets the text from the li that was clicked
                $(this).parent().prev().text(questionType); //changes the dropdown buttons text to the li's text
                alert(getQuestionNumber(getPanel($(this))));
                var questionNumber = $(this).parent().attr("data-question-number"); //get Question Number
                $("#question-div-"+questionNumber).html(""); //clear whatever's inside the div

                //This switch determines the question type based on the dropdown that was clicked
                switch(questionType){ 
                    case "Multiple Choice":
                        // this will break because it just uses the count rather than checking the count for this particular dorpdown
                        $("#question-div-" + questionNumber).append(
                            $("<p>", {"text": "Choices"}),
                            $("<input>", {
                                //"id": "mc-input",
                                "type": "text",
                                "placeholder": "New Choice"
                            }),
                            $("<div>", {"class": "text-center"}).append(
                                $("<a>", {
                                    //"id": mc-add-choice-btn,                                    
                                    "class": "button success semiround small",
                                    "text": "Add Choice"
                                })
                            )
                        )
                        break;

                    case "Free Response":
                        break;

                    case "Fill in the Blank":
                        break;

                    case "Matching":
                        break;
                }
            });
            /*
            $('#mc_add_choice_btn').click(function(){
                $('#mc_input').before("<input type='radio' name='rad-group-"+count+>");
                var mc_input_text = $('#mc_input').val();
                $('#mc_input').prev().val(mc_input_text);
                var new_mc_option_lab = '<label>'+ mc_input_text +'</label><br>';
                $('#mc_input').before(new_mc_option_lab);
                $('#mc_input').val('');        
                //$(this).prev().val($('#mc_input').text());
            });
            */
           // $([data-question-number])
        </script>
    </body>
</html>